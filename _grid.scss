.grid {
	display: grid;
	gap: $gap
}

.row {
	display: flex;
	flex-wrap: wrap;
	gap: $gap;
	> * {
		flex: 0 100%;
	}
	&.col-fixed > *,
	> .col-fixed {
		flex: 1;
	}
	&.col-auto > *,
	> .col-auto {
		flex: auto;
	}
}

@for $i from 1 through 12 {
	[class*="grid"].col-#{$i} {
		grid-template-columns: repeat($i, 1fr)
	}
	.grid-#{$i}00 {
		display: grid;
		gap: $gap;
		grid-template-columns: repeat( auto-fit, minmax(#{$i}00px, 1fr));
	}
	[class*="row"].col-#{$i} > * {
		flex: 0 calc(#{(round(percentage(1 / $i) * 1000) / 1000)} - #{($gap - (round(($gap / $i) * 1000) / 1000))});
	}
	@if $i > 1 {
		.row.g-0.col-#{$i} > * {
			max-width: #{(round(percentage(1 / $i) * 1000) / 1000)};
			flex: 0 #{(round(percentage(1 / $i) * 1000) / 1000)};
		}
	}

	.row > .col-#{$i} {
		flex: calc(#{(round(percentage($i / 12) * 1000) / 1000)} - #{$gap});
		@if $i < 12 {
			max-width: calc(#{(round(percentage($i / 12) * 1000) / 1000)} - #{(round(($gap / $i) * 1000) / 1000)});
		}
	}

	[class*="row"].g-0 > .col-#{$i} {
		flex: 0 #{(round(percentage($i / 12) * 1000) / 1000)};
		@if $i < 12 {
			max-width: #{(round(percentage($i / 12) * 1000) / 1000)};
		}
	}
	
}
@each $breakpoint, $breakpoint_width in $breakpoints {

	.#{$breakpoint}-row {
		display: flex;
		flex-wrap: wrap;
		gap: $gap;
		> * {
			flex: 0 100%;
		}
		&.col-fixed > *,
		> .col-fixed {
			flex: 1;
		}
		&.col-auto > *,
		> .col-auto {
			flex: auto;
		}
	}

	.#{$breakpoint}-mw {
		max-width: $breakpoint_width;
	}

	@media screen and (min-width: $breakpoint_width) {
		.#{$breakpoint}-grid {
			display: grid;
			gap: $gap
		}

		.#{$breakpoint}-row {
			> * {
				flex: 1;
			}
		}

		[class*="row"].#{$breakpoint}-col-fixed > *,
		[class*="row"] > .#{$breakpoint}-col-fixed {
			flex: 1;
		}
		[class*="row"].#{$breakpoint}-col-auto > *,
		[class*="row"] > .#{$breakpoint}-col-auto {
			flex: auto;
		}
		
		@for $i from 1 through 12 {
			[class*="grid"].#{$breakpoint}-col-#{$i} {
				grid-template-columns: repeat($i, 1fr)
			}
			[class*="row"].#{$breakpoint}-col-#{$i} > * {
				flex: 0 calc(#{(round(percentage(1 / $i) * 1000) / 1000)} - #{($gap - (round(($gap / $i) * 1000) / 1000))});
			}
			@if $i > 1 {
				[class*="row"].g-0.#{$breakpoint}-col-#{$i} > * {
					max-width: #{(round(percentage(1 / $i) * 1000) / 1000)};
					flex: 0 #{(round(percentage(1 / $i) * 1000) / 1000)};
				}
			}

			[class*="row"] > .#{$breakpoint}-col-#{$i},
			.#{$breakpoint}-row > .col-#{$i} {
				flex: calc(#{(round(percentage($i / 12) * 1000) / 1000)} - #{$gap});
				@if $i < 12 {
					max-width: calc(#{(round(percentage($i / 12) * 1000) / 1000)} - #{(round(($gap / $i) * 1000) / 1000)});
				}
			}

			[class*="row"].g-0 > .#{$breakpoint}-col-#{$i},
			.#{$breakpoint}-row.g-0 > .col-#{$i} {
				flex: 0 #{(round(percentage($i / 12) * 1000) / 1000)};
				@if $i < 12 {
					max-width: #{(round(percentage($i / 12) * 1000) / 1000)};
				}
			}
		}
		@each $s, $space in $spacing {
			.#{$breakpoint}-g-#{$s} {
				gap: #{$space};
			}
		}
	}
}
@each $i, $space in $spacing {
	.g-#{$i} {
		gap: #{$space};
	}
}